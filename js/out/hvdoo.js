/**
 * Copyright (c) 2013 Rodrigo Silveira. All rights reserved
 */
var HVdoo=HVdoo||{};HVdoo.components=HVdoo.components||{};HVdoo.entities=HVdoo.entities||{};HVdoo.util=HVdoo.util||{};HVdoo.util.graphics=HVdoo.util.graphics||{};HVdoo.util.input=HVdoo.util.input||{};HVdoo.util.math=HVdoo.util.math||{};HVdoo.components.Component=function(){this.exec=function(){}};
HVdoo.components.ComponentManager=function(){var b={},c=function(){HVdoo.components.Component.call(this);this.has=function(a){return void 0!==this.get(a)};this.set=function(a,d){b[a]=d};this.get=function(a){return b[a]};this.exec=function(){for(var a in b)b[a]instanceof HVdoo.components.Component&&b[a].exec()}};c.prototype=Object.create(HVdoo.components.Component.prototype);return c}();
HVdoo.components.Drawable=function(){var b,c,a=0,d=0,h=0,f=0,e=function(e,k,g,m,n,p,q,r,s){b=new HVdoo.util.math.Vec2(m||64,n||64);c=new Image;c.src=g;a=p||0;d=q||0;h=r||m;f=s||n;this.exec=function(){var g=k.getPos().get(),m=b.get();e.render(c,a,d,h,f,g.x,g.y,m.x,m.y)};this.getSize=function(){return b};this.setSize=function(a){b=a}};e.prototype=Object.create(HVdoo.components.Component.prototype);return e}();
HVdoo.components.Movement=function(){var b,c=function(a,d){b=0;this.exec=function(){a.getDir().zero();b=0;d.isSet("LEFT")&&(b-=1);d.isSet("RIGHT")&&(b+=1);a.setDir(b,null);a.move()}};c.prototype=Object.create(HVdoo.components.Component.prototype);return c}();
HVdoo.components.Physics=function(){var b,c,a,d,h,f,e=function(e,k,g){g=g||{};b=g.gravity||0.75;a=g.velocity_y||-15;c=0;d=!1;h=!0;f=!1;this.exec=function(){k.isSet("SPACE")?d||(h||f)||(h=d=!0,c=a,f=!0):f=!1;if(d||h)c+=b,e.getPos().add(null,c);300<e.getPos().get().y&&(e.setPos(null,300),h=d=!1)}};e.prototype=Object.create(HVdoo.components.Component.prototype);return e}();
HVdoo.entities.Entity=function(b,c,a,d,h){var f=new HVdoo.util.math.Vec2(b||0,c||0),e=new HVdoo.util.math.Vec2(0,0),l=new HVdoo.util.math.Vec2(a||5,d||5),k;this.update=function(){h.exec()};this.draw=function(){void 0!==k&&k.exec()};this.setSprite=function(a){k=a||null};this.getPos=function(){return f};this.setPos=function(a,b){f.set(a,b)};this.getDir=function(){return e};this.setDir=function(a,b){e.set(a,b)};this.getVel=function(){return l};this.setVel=function(a,b){l.set(a,b)};this.move=function(){var a=
e.get(),b=l.get();f.add(a.x*b.x,a.y*b.y)}};HVdoo.util.graphics.Renderer2D=function(b,c){var a=document.createElement("canvas");a.setAttribute("width",b||800);a.setAttribute("height",c||450);var d=a.getContext("2d");this.render=function(a,b,c,l,k,g,m,n,p){d.drawImage(a,b,c,l,k,g,m,n,p)};this.clear=function(b,c,e,l){d.clearRect(b||0,c||0,e||a.width,l||a.height)};this.getCanvas=function(){return a};this.attach=function(b){b instanceof HTMLElement&&b.appendChild(a)}};
HVdoo.util.input.Controller=function(){var b={},c={SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,A:65,S:83,D:68,F:70};this.isSet=function(a){return b[c[a]]};this.onKeyDown=function(a){b[a.keyCode]=!0};this.onKeyUp=function(a){b[a.keyCode]=!1}};
HVdoo.util.math.Vec2=function(b,c){var a={x:b||0,y:c||0};this.add=function(b,c){a.x+=b||0;a.y+=c||0};this.subt=function(b,c){a.x-=b||0;a.y-=c||0};this.mult=function(b){a.x*=b;a.y*=b};this.normalize=function(){var b=Math.sqrt(a.x*a.x+a.y*a.y);a.x/=b;a.y/=b;return a};this.get=function(){return a};this.set=function(b,c){a.x=b||a.x;a.y=c||a.y;return a};this.zero=function(){a.x=0;a.y=0}};