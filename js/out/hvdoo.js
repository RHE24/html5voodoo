/**
 * Copyright (c) 2013 Rodrigo Silveira. All rights reserved
 */
var HVdoo=HVdoo||{};HVdoo.components=HVdoo.components||{};HVdoo.entities=HVdoo.entities||{};HVdoo.util=HVdoo.util||{};HVdoo.util.graphics=HVdoo.util.graphics||{};HVdoo.util.input=HVdoo.util.input||{};HVdoo.util.math=HVdoo.util.math||{};HVdoo.components.Component=function(){this.exec=function(){}};
HVdoo.components.ComponentManager=function(){var b={},c=function(){HVdoo.components.Component.call(this);this.has=function(a){return void 0!==this.get(a)};this.set=function(a,c){b[a]=c};this.get=function(a){return b[a]};this.exec=function(){for(var a in b)b[a]instanceof HVdoo.components.Component&&b[a].exec()}};c.prototype=Object.create(HVdoo.components.Component.prototype);return c}();
HVdoo.components.Drawable=function(){var b,c,a=0,e=0,m=0,l=0,d=function(d,g,k,h,n,p,q,r,s){b=new HVdoo.util.math.Vec2(h||64,n||64);c=new Image;c.src=k;a=p||0;e=q||0;m=r||h;l=s||n;this.exec=function(){var k=g.getPos().get(),h=b.get();d.render(c,a,e,m,l,k.x,k.y,h.x,h.y)};this.getSize=function(){return b};this.setSize=function(a){b=a}};d.prototype=Object.create(HVdoo.components.Component.prototype);return d}();
HVdoo.components.Movement=function(){var b=function(b,a){this.exec=function(){b.getDir().zero();a.isSet("UP")&&b.setDir(null,-1);a.isSet("DOWN")&&b.setDir(null,1);a.isSet("LEFT")&&b.setDir(-1,null);a.isSet("RIGHT")&&b.setDir(1,null);b.move()}};b.prototype=Object.create(HVdoo.components.Component.prototype);return b}();
HVdoo.entities.Entity=function(b,c,a,e,m){var l=new HVdoo.util.math.Vec2(b||0,c||0),d=new HVdoo.util.math.Vec2(0,0),f=new HVdoo.util.math.Vec2(a||5,e||5),g;this.update=function(){m.exec()};this.draw=function(){void 0!==g&&g.exec()};this.setSprite=function(a){g=a||null};this.getPos=function(){return l};this.getDir=function(){return d};this.setDir=function(a,b){d.set(a,b)};this.getVel=function(){return f};this.setVel=function(a,b){f.set(a,b)};this.move=function(){var a=d.get(),b=f.get();l.add(a.x*b.x,
a.y*b.y)}};HVdoo.util.graphics.Renderer2D=function(b,c){var a=document.createElement("canvas");a.setAttribute("width",b||800);a.setAttribute("height",c||450);var e=a.getContext("2d");this.render=function(a,b,c,f,g,k,h,n,p){e.drawImage(a,b,c,f,g,k,h,n,p)};this.clear=function(b,c,d,f){e.clearRect(b||0,c||0,d||a.width,f||a.height)};this.getCanvas=function(){return a};this.attach=function(b){b instanceof HTMLElement&&b.appendChild(a)}};
HVdoo.util.input.Controller=function(){var b={},c={SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,A:65,S:83,D:68,F:70};this.isSet=function(a){return b[c[a]]};this.onKeyDown=function(a){b[a.keyCode]=!0};this.onKeyUp=function(a){b[a.keyCode]=!1}};
HVdoo.util.math.Vec2=function(b,c){var a={x:b||0,y:c||0};this.add=function(b,c){a.x+=b||0;a.y+=c||0};this.subt=function(b,c){a.x-=b||0;a.y-=c||0};this.mult=function(b){a.x*=b;a.y*=b};this.normalize=function(){var b=Math.sqrt(a.x*a.x+a.y*a.y);a.x/=b;a.y/=b;return a};this.get=function(){return a};this.set=function(b,c){a.x=b||a.x;a.y=c||a.y;return a};this.zero=function(){a.x=0;a.y=0}};